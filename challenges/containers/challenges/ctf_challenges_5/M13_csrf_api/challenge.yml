name: CSRF API
category: Web
value: 20
description: |-
  <p><strong>Cenário:</strong></p>
  <p>
    A API bancária usa cookies para autenticação porém habilita CORS com <code>*</code> e credenciais. Qualquer página
    pode disparar transferências em nome do usuário logado.
  </p>
  <p>
    <code>Recurso / Acesso:</code>
    <strong>Portal de transferências (container individual)</strong>
  </p>
  <p><strong>Objetivo:</strong><br>Disparar uma transferência para <code>shadow</code> com R$ 1.200 reutilizando o cookie e capturar a flag.</p>
  <hr>
  <p>APIs com cookies devem usar CSRF tokens e CORS restritivo.</p>
attribution: ""
type: container
extra:
  initial: 20
  decay: 0
  minimum: 20
connection_info: Container
flags:
  - ITAU2025{csrf_cookie_api}
hints:
  - content: >-
      Faça uma chamada cross-site ou use o próprio console com <code>fetch('/api/transfer', {method:'POST',credentials:'include',body:'{"to":"shadow","amount":1200}',headers:{'Content-Type':'application/json'}})</code>.
    cost: 5
