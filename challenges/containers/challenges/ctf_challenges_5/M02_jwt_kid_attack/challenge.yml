name: Token Confuso
category: Web
description: "<p><strong>Cenário:</strong></p>\n<p>\n  A API de integrações aceita\
  \ tokens de fornecedores e seleciona a chave secreta através do campo <code>kid</code>\n\
  \  informado no cabeçalho. Para manter compatibilidade, o time deixou o algoritmo\
  \ <code>none</code> habilitado e não\n  sanitiza o valor do identificador da chave.\n\
  </p>\n<p>\n  <code>Recurso / Acesso:</code>\n  <strong>URL da API de tokens (container\
  \ individual)</strong>\n</p>\n<p><strong>Objetivo:</strong><br> Forjar um JWT administrativo\
  \ e acessar o endpoint <code>/api/admin</code> para capturar a flag.</p>\n<hr>\n\
  <p>Tokens assinados precisam de algoritmos fixos e chaves imutáveis, não fornecidas\
  \ pelo cliente.</p>"
attribution: ''
value: 20
type: container
extra:
  initial: 20
  decay: 0
  minimum: 20
connection_info:
  type: web
  port: 8080
flags:
  - ITAU2025{jwt_kid_none_alg}
hints:
  - content: 'Utilize um cabeçalho com <code>"alg": "none"</code> e remova a assinatura
      para que o servidor aceite o payload editado.'
    cost: 5
state: visible
image: ctf/token-confuso:latest
