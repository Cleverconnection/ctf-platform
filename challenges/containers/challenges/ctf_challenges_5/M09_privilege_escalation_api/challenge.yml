name: Patch Indireto
category: Web
value: 20
description: |-
  <p><strong>Cenário:</strong></p>
  <p>
    A API de perfis usa JSON Merge Patch e mantém compatibilidade com clientes que enviam apenas strings de role.
    Essa conversão inadvertidamente permite promover o usuário a administrador.
  </p>
  <p>
    <code>Recurso / Acesso:</code>
    <strong>URL da API de perfis (container individual)</strong>
  </p>
  <p><strong>Objetivo:</strong><br>Enviar um PATCH que defina o campo <code>role</code> como string “admin” e acessar <code>/flag</code>.</p>
  <hr>
  <p>Ao evoluir APIs, remova suportes legados inseguros e valide tipos esperados.</p>
attribution: ""
type: container
extra:
  initial: 20
  decay: 0
  minimum: 20
connection_info: Container
flags:
  - ITAU2025{api_privilege_escalation}
hints:
  - content: >-
      Envie <code>{"role": "admin"}</code> em um PATCH — o servidor converterá a role inteira em string.
    cost: 5
