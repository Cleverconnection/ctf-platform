name: OTP Previsível
category: Web
value: 20
description: |-
  <p><strong>Cenário:</strong></p>
  <p>
    O serviço de OTP gera códigos apenas com os últimos dígitos do documento, sem entropia real. Basta deduzir a
    fórmula para validar a sessão.
  </p>
  <p>
    <code>Recurso / Acesso:</code>
    <strong>Central de OTP (container individual)</strong>
  </p>
  <p><strong>Objetivo:</strong><br>Calcular o OTP válido para a conta monitorada e recuperar a flag.</p>
  <hr>
  <p>Tokens temporários devem usar algoritmos com segredo compartilhado e clocks seguros.</p>
attribution: ""
type: container
extra:
  initial: 20
  decay: 0
  minimum: 20
connection_info: Container
flags:
  - ITAU2025{predictable_otp_bypass}
hints:
  - content: >-
      Compare a dica do endpoint <code>/api/send</code> com o número da conta e deduza que o OTP é <code>(doc % 1e6) * 3</code> mod <code>1e6</code>.
    cost: 5
